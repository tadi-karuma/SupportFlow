# ❓ QnA構文仕様 – SupportFlow用質問エンジン（仮）

## 1. 質問セット構成

質問セットは1つの制度群に対して定義される。  
各質問は以下の要素を持つ：

- `id`: 質問識別子（例: q001）
- `text`: 表示する質問文
- `type`: 選択肢形式（single/multi/yesno/number）
- `options`: 選択肢リスト（任意）
- `map`: 各選択肢が影響を与える制度判定ロジック

```json
{
  "id": "q001",
  "text": "あなたの年齢層は？",
  "type": "single",
  "options": ["18歳未満", "18〜64歳", "65歳以上"],
  "map": {
    "65歳以上": ["制度A", "制度C"]
  }
}
```

---

## 2. 判定ロジックの例（if-then形式）

```pseudo
IF
  q001 = "65歳以上" AND
  q003 = "一人暮らし"
THEN
  提示:「高齢者生活支援給付（制度A）」
```

---

## 3. 設問パッケージ構成例（制度別）

```json
{
  "制度A": {
    "questions": ["q001", "q003", "q007"],
    "logic": [
      {"if": {"q001": "65歳以上", "q003": "一人暮らし"}, "then": "提示"}
    ],
    "required_docs": ["本人確認書類", "住民票"]
  }
}
```

---

## 4. 属性自動補完との統合設計（マイナンバー等）

属性が自動取得できる場合、対応する質問に「prefill」キーを付与：

```json
{
  "id": "q004",
  "text": "扶養親族の有無",
  "type": "yesno",
  "prefill": "from_mynumber.income_data.dependents"
}
```

---

## 5. 実装時の注意

- 回答はすべてJSON形式で収集し、匿名デバッグが可能
- モジュール単位で質問更新・制度更新ができるよう分離
- 構文のバージョン管理を行う（例：構文v1.0 → v1.1）
